HomeScreen As screen:
    Fill: |
        =RGBA(255,255,255,1)
    Height: =Max(App.Height, App.DesignHeight)
    OnHidden: =Set(_showDetails, false)
    OnVisible: |-
        =Concurrent(
            Set(_navMenuSelect, "My Leave Requests"),
            //if not manager view, refresh my balance collection when on this screen
            If(!_managerView, Set(_requesterBalanceRecord, LookUp(BalanceCollection, Year = Text(Year(Now())) && EmployeeEmail = _myProfile.UserPrincipalName));
                ClearCollect(RequesterBalanceCollection, 
                { type: "Vacation", balance: Value(_requesterBalanceRecord.Vacation) - Value(_requesterBalanceRecord.VacationUsed)},
                {type:"Sick Leave", balance:Value(_requesterBalanceRecord.Sick)-Value(_requesterBalanceRecord.SickUsed)},
                {type:"Floating Holiday", balance:Value(_requesterBalanceRecord.Floating)-Value(_requesterBalanceRecord.FloatingUsed)},
                {type:"Jury Duty", balance:Value(_requesterBalanceRecord.JuryDuty)-Value(_requesterBalanceRecord.JuryDutyUsed)},
                {type:"Bereavement", balance:Value(_requesterBalanceRecord.Bereavement)-Value(_requesterBalanceRecord.BereavementUsed)})
            ),
            Set(_showDetails, false)
        );
    Orientation: =If(HomeScreen.Width < HomeScreen.Height, Layout.Vertical, Layout.Horizontal)
    Size: =1 + CountRows(App.SizeBreakpoints) - CountIf(App.SizeBreakpoints, Value >= HomeScreen.Width)
    Width: =Max(App.Width, App.DesignWidth)

    "Gallery7 As gallery.'BrowseLayout_Vertical_ThreeTextVariant_ver5.0'":
        DelayItemLoading: =true
        Height: =601
        Items: =Filter(Table1_16,If(FilterByApproved = true, Status = "Approved", Status<>""),'Created By' = User().FullName)
        Layout: =Layout.Vertical
        LoadingSpinner: =LoadingSpinner.Data
        OnSelect: =
        TemplatePadding: =0
        TemplateSize: =197
        Visible: =!_managerView=true
        Width: =943
        X: =224
        Y: =164
        ZIndex: =1

        Title2 As label:
            Color: =RGBA(62, 96, 170, 1)
            Font: =Font.Lato
            FontWeight: =FontWeight.Bold
            Height: =Self.Size * 1.8
            OnSelect: =Select(Parent)
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =0
            Size: =15
            Text: =ThisItem.'Created By'
            VerticalAlign: =VerticalAlign.Top
            Width: =Parent.TemplateWidth - 86
            X: =14
            Y: =13
            ZIndex: =1

        Subtitle2 As label:
            Height: =25
            OnSelect: =Select(Parent)
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =0
            Size: =13
            Text: =ThisItem.'Start Date'
            VerticalAlign: =VerticalAlign.Top
            Width: =412
            X: =135
            Y: =73
            ZIndex: =2

        Body1 As label:
            Height: =22
            OnSelect: =Select(Parent)
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =0
            Text: =ThisItem.'Leave Type'
            VerticalAlign: =VerticalAlign.Top
            Width: =737
            X: =144
            Y: =132
            ZIndex: =3

        NextArrow2 As icon.ChevronRight:
            AccessibleLabel: =Self.Tooltip
            Color: =RGBA(166, 166, 166, 1)
            Height: =50
            Icon: =Icon.ChevronRight
            OnSelect: =Select(Parent)
            PaddingBottom: =16
            PaddingLeft: =16
            PaddingRight: =16
            PaddingTop: =16
            Tooltip: ="View item details"
            Width: =50
            X: =Parent.TemplateWidth - Self.Width - 12
            Y: =(Parent.TemplateHeight / 2) - (Self.Height / 2)
            ZIndex: =4

        Separator2 As rectangle:
            Fill: =RGBA(255, 255, 255, 1)
            Height: =8
            OnSelect: =Select(Parent)
            Width: =Parent.TemplateWidth
            Y: =Parent.TemplateHeight - Self.Height
            ZIndex: =5

        Label16 As label:
            FontWeight: =FontWeight.Semibold
            Height: =153
            OnSelect: =Select(Parent)
            Text: |-
                ="Start date:
                
                End date:
                
                Leave Type:"
            X: =28
            Y: =25
            ZIndex: =7

        Label17 As label:
            Height: =26
            OnSelect: =Select(Parent)
            Text: =ThisItem.'End Date'
            Width: =236
            X: =135
            Y: =92
            ZIndex: =8

        Rectangle14 As rectangle:
            Fill: =RGBA(217, 216, 217, 1)
            Height: =2
            OnSelect: =Select(Parent)
            Width: =826
            Y: =187
            ZIndex: =9

        Label26_1 As label:
            Align: =Align.Center
            BorderColor: |
                =If((ThisItem.Status)="Pending",RGBA(0,71,144,1),
                (ThisItem.Status)="Rejected",RGBA(213,0,0,1),
                (ThisItem.Status)="Approved",RGBA(0,128,0,1))
            BorderThickness: =3
            Color: |
                =If((ThisItem.Status)="Pending",RGBA(0,71,144,1),
                (ThisItem.Status)="Rejected",RGBA(213,0,0,1),
                (ThisItem.Status)="Approved",RGBA(0,128,0,1))
            DisabledBorderColor: =RGBA(101, 128, 187, 1)
            Fill: =RGBA(255, 255, 255, 1)
            Font: =Font.'Lato Black'
            FontWeight: =FontWeight.Bold
            OnSelect: =Select(Parent)
            Text: =ThisItem.Status
            X: =639
            Y: =112
            ZIndex: =10

    Rectangle3 As rectangle:
        DisabledFill: =Rectangle3.Fill
        Fill: =RGBA(249, 249, 249, 1)
        FocusedBorderColor: =Rectangle3.BorderColor
        Height: =695
        HoverFill: =Rectangle3.Fill
        PressedFill: =Rectangle3.Fill
        Width: =303
        X: =1063
        Y: =73
        ZIndex: =3

    "GalleryRequests As gallery.'BrowseLayout_Vertical_TwoTextVariant_ver4.0'":
        AccessibleLabel: ="Leave request gallery"
        Default: =Blank()
        DisabledBorderColor: =GalleryRequests.BorderColor
        DisabledFill: =GalleryRequests.Fill
        Height: =606
        HoverBorderColor: =GalleryRequests.BorderColor
        HoverFill: =GalleryRequests.Fill
        Items: |-
            =//Filter values based on _requestTypeFilter, set by selecting item in GalleryFilters. Sort by StartDate, descending.
            Sort(
                If(_requestTypeFilter="All",
                  Filter(LeaveCollection, If(_managerView, Approver = _myProfile.UserPrincipalName, Requester = _myProfile.UserPrincipalName)), 
                  Filter(LeaveCollection, Status=_requestTypeFilter && If(_managerView, Approver = _myProfile.UserPrincipalName, Requester = _myProfile.UserPrincipalName)) ), StartDate, SortOrder.Descending)
        Layout: =Layout.Vertical
        LoadingSpinnerColor: =GalleryRequests.BorderColor
        OnSelect: |-
            =Set(_selectedLeaveItem, ThisItem);
            
            If(_managerView, 
                //If manager view, get user's leave balance record and determine any overlaps this request has from other people I manage
                Set(_requesterBalanceRecord, LookUp(BalanceCollection, Year = Text(Year(Now())) && EmployeeEmail = ThisItem.Requester));
                ClearCollect(RequestOverlaps, Filter(LeaveCollection, EndDate >= _selectedLeaveItem.StartDate && StartDate <= _selectedLeaveItem.EndDate 
                && Requester <>_selectedLeaveItem.Requester));
                
                If(CountRows(RequestOverlaps) > 0, Set(_requestOverlapMessage, Concat(ForAll(Distinct(RequestOverlaps, Requester), {Result: ThisRecord.Value}), Result, ", ")))
            );
            
            Concurrent(
                //gather requester or approver info depending on view
                If(_managerView, 
                    Set(_requester, Office365Users.UserProfile(ThisItem.Requester)), 
                    Set(_selectedApprover, Office365Users.UserProfile(ThisItem.Approver)); If(Office365Users.UserPhotoMetadata(_selectedApprover.Id).HasPhoto, Set(_selectedApproverPhoto, Office365Users.UserPhoto(_selectedApprover.Id)))),
                //**** CALCULATION USED TO DETERMINE TOTAL WORK DAYS REQUESTED ****
                 Set(_inclusiveTotalDaysRequested, DateDiff(ThisItem.StartDate, ThisItem.EndDate, TimeUnit.Days) + 1);
                    Set(_numFullWeeks, RoundDown(_inclusiveTotalDaysRequested / 7, 0));
                    Set(_numFullDaysPartialWeek, _inclusiveTotalDaysRequested - _numFullWeeks * 7);
                    Set(_startWeekday, Weekday(ThisItem.StartDate)); 
                    Set(_endWeekday, Weekday(ThisItem.EndDate));
            
            
                   //calculates the number of business days in the partial week left over after whole weeks are subtracted out of total days requested
                If(_numFullDaysPartialWeek = 6, 
                    If(_startWeekday <= 2, Set(_numPartialWeekdays, 5), Set(_numPartialWeekdays, 4)
                    ),
                  _numFullDaysPartialWeek = 5,
                    If(_startWeekday = 2, Set(_numPartialWeekdays, 5), _startWeekday = 1 || _startWeekday = 3 || _startWeekday = 4, Set(_numPartialWeekdays, 4), Set(_numPartialWeekdays, 3)
                    ),
                  _numFullDaysPartialWeek = 4,
                    If(_startWeekday = 2 || _startWeekday = 3, Set(_numPartialWeekdays, 4), _startWeekday = 1 || _startWeekday = 4, Set(_numPartialWeekdays, 3), Set(_numPartialWeekdays, 2)
                    ),
                  _numFullDaysPartialWeek = 3,
                    If(_startWeekday = 6 || _startWeekday = 7, Set(_numPartialWeekdays, 1), _startWeekday = 1 || _startWeekday = 5, Set(_numPartialWeekdays, 2), Set(_numPartialWeekdays, 3)
                    ),
                  _numFullDaysPartialWeek = 2,
                    If(_startWeekday = 7, Set(_numPartialWeekdays, 0), _startWeekday = 1 || _startWeekday = 6, Set(_numPartialWeekdays, 1), Set(_numPartialWeekdays, 2)),
                  _numFullDaysPartialWeek = 1,
                    If(_startWeekday = 1 || _startWeekday = 7, Set(_numPartialWeekdays, 0), Set(_numPartialWeekdays, 1)
                    ),
                  _numFullDaysPartialWeek = 0, Set(_numPartialWeekdays, 0)
                );
                  Set(_workDaysInRequest, _numFullWeeks * 5 + _numPartialWeekdays),
                  Set(_holidaysInRequest, CountIf(HolidaysCollection, StartDate >= ThisItem.StartDate, StartDate <= ThisItem.EndDate))
            );
            Set(_requestedDays, _workDaysInRequest - _holidaysInRequest);
            //**** END CALCULATION ****
            Set(_showDetails, true);
        PressedBorderColor: =GalleryRequests.BorderColor
        PressedFill: =GalleryRequests.Fill
        ShowScrollbar: =false
        TemplateFill: =If(ThisItem.IsSelected, RGBA(249, 249, 249, 1))
        TemplateSize: =128
        Visible: =CountRows(GalleryRequests.AllItems) > 0
        Width: =775
        X: =232
        Y: =162
        ZIndex: =12

        Label3 As label:
            Color: =RGBA(10, 106, 204, 1)
            FocusedBorderColor: =Label3.BorderColor
            FocusedBorderThickness: =2
            Font: =Font.Lato
            FontWeight: =FontWeight.Bold
            Height: =Label3.Size * 1.7
            HoverBorderColor: =Label3.BorderColor
            HoverColor: =Label3.Color
            HoverFill: =Label3.Fill
            OnSelect: =Select(Parent)
            PressedBorderColor: =Label3.BorderColor
            PressedColor: =Label3.Color
            PressedFill: =Label3.Fill
            Size: =18
            Text: =ThisItem.Title
            Width: =620
            X: =6
            Y: =15
            ZIndex: =1

        Label5 As label:
            FocusedBorderColor: =Label5.BorderColor
            FocusedBorderThickness: =2
            Font: =Font.'Lato Light'
            Height: =Label5.Size * 1.8
            HoverBorderColor: =Label5.BorderColor
            HoverColor: =Label5.Color
            HoverFill: =Label5.Fill
            OnSelect: =Select(Parent)
            PressedBorderColor: =Label5.BorderColor
            PressedColor: =Label5.Color
            PressedFill: =Label5.Fill
            Size: =13.5
            Text: =Text(ThisItem.StartDate,"[$-en-US]dddd, mmm. dd, yyyy") & If(DateDiff(ThisItem.StartDate, ThisItem.EndDate, TimeUnit.Days) <> 0, " - " & Text(ThisItem.EndDate,"[$-en-US]dddd, mmm. dd, yyyy"))
            Width: =658
            X: =6
            Y: =57
            ZIndex: =2

        Label6 As label:
            FocusedBorderColor: =Label6.BorderColor
            FocusedBorderThickness: =2
            Font: =Font.Lato
            Height: =30
            HoverBorderColor: =Label6.BorderColor
            HoverColor: =Label6.Color
            HoverFill: =Label6.Fill
            OnSelect: =Select(Parent)
            PressedBorderColor: =Label6.BorderColor
            PressedColor: =Label6.Color
            PressedFill: =Label6.Fill
            Size: =10.5
            Text: =If(_managerView, ThisItem.Requester, ThisItem.Detail)
            Width: =381
            X: =6
            Y: =88
            ZIndex: =3

        RequestStatus As button:
            BorderColor: =RequestStatus.Color
            Color: |-
                =If(Upper(ThisItem.Status)="PENDING",RGBA(0, 71, 144, 1),
                Upper(ThisItem.Status)="DECLINED",RGBA(213, 0, 0, 1),
                Upper(ThisItem.Status)="APPROVED",RGBA(0, 128, 0, 1))
            DisabledBorderColor: =ColorFade(RequestStatus.BorderColor, 70%)
            Fill: =RGBA(255, 255, 255, 1)
            FocusedBorderColor: =RequestStatus.BorderColor
            Font: =Font.Lato
            Height: =30
            HoverBorderColor: =RequestStatus.BorderColor
            HoverColor: =RequestStatus.Color
            HoverFill: =ColorFade(RequestStatus.Fill, 20%)
            OnSelect: =Select(Parent)
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =0
            PressedBorderColor: =RequestStatus.BorderColor
            PressedColor: =RequestStatus.Fill
            PressedFill: =RequestStatus.Color
            RadiusBottomLeft: =4
            RadiusBottomRight: =4
            RadiusTopLeft: =4
            RadiusTopRight: =4
            Size: =10.5
            Text: =Upper(ThisItem.Status)
            Width: =88
            X: =638
            Y: =16
            ZIndex: =4

        Rectangle2 As rectangle:
            AccessibleLabel: =ThisItem.Title
            DisabledFill: =Rectangle2.Fill
            Fill: =RGBA(202, 202, 202, 1)
            FocusedBorderColor: =Rectangle2.BorderColor
            Height: =1.5
            HoverFill: =Rectangle2.Fill
            OnSelect: =Select(Parent)
            PressedFill: =Rectangle2.Fill
            Width: =Parent.TemplateWidth
            Y: =Parent.TemplateHeight - Rectangle2.Height
            ZIndex: =5

    RectNavSep As rectangle:
        DisabledFill: =RectNavSep.Fill
        Fill: =RGBA(204, 204, 204, 1)
        FocusedBorderColor: =RectNavSep.BorderColor
        Height: =688
        HoverFill: =RectNavSep.Fill
        PressedFill: =RectNavSep.Fill
        Width: =1
        X: =231
        Y: =80
        ZIndex: =30

    Rectangle2_1 As rectangle:
        DisabledFill: =Rectangle2_1.Fill
        Fill: =RGBA(202, 202, 202, 1)
        FocusedBorderColor: =Rectangle2_1.BorderColor
        Height: =1
        HoverFill: =Rectangle2_1.Fill
        OnSelect: =
        PressedFill: =Rectangle2_1.Fill
        Width: =GalleryRequests.TemplateWidth
        X: =GalleryRequests.X + 5
        Y: =GalleryRequests.Y + 4
        ZIndex: =35

    GroupEmptyState As group:
        Height: =5
        Width: =5
        X: =40
        Y: =40
        ZIndex: =36

        LblFirstRequest As label:
            Align: =LayoutAlignItems.Center
            FocusedBorderColor: =LblFirstRequest.BorderColor
            Font: =Font.Lato
            Height: =93
            HoverBorderColor: =LblFirstRequest.BorderColor
            HoverColor: =LblFirstRequest.Color
            HoverFill: =LblFirstRequest.Fill
            PressedBorderColor: =LblFirstRequest.BorderColor
            PressedColor: =LblFirstRequest.Color
            PressedFill: =LblFirstRequest.Fill
            Size: =20
            Text: ="Make your first leave request!"
            Visible: =If(IsEmpty(Table1_14),true,false)
            Width: =400
            X: =425
            Y: =322
            ZIndex: =31

        Circle1 As circle:
            AccessibleLabel: ="Create new leave request"
            DisabledFill: =Circle1.Fill
            Fill: =RGBA(12, 132, 255, 1)
            FocusedBorderColor: =Circle1.BorderColor
            Height: =60
            HoverFill: =Circle1.Fill
            OnSelect: =Select(IconHeaderCreateNew)
            PressedFill: =Circle1.Fill
            Visible: =If(IsEmpty(Table1_14),true,false)
            Width: =64
            X: =icon7.X
            Y: =392
            ZIndex: =32

        icon7 As icon.Add:
            AccessibleLabel: ="Create new leave request"
            Color: =Color.White
            DisabledFill: =icon7.Fill
            FocusedBorderColor: =icon7.BorderColor
            Height: =60
            HoverBorderColor: =ColorFade(icon7.BorderColor, 20%)
            HoverColor: =ColorFade(icon7.Color, 20%)
            HoverFill: =icon7.Fill
            Icon: =Icon.Add
            OnSelect: =Select(IconHeaderCreateNew)
            PaddingBottom: =10
            PaddingLeft: =10
            PaddingRight: =10
            PaddingTop: =10
            PressedBorderColor: =ColorFade(icon7.BorderColor, -20%)
            PressedColor: =ColorFade(icon7.Color, -20%)
            PressedFill: =icon7.Fill
            TabIndex: =0
            Visible: =If(IsEmpty(Table1_14),true,false)
            X: =579
            Y: =392
            ZIndex: =33

        LblEmptyRequests As label:
            FocusedBorderColor: =LblEmptyRequests.BorderColor
            Font: =Font.Lato
            FontWeight: =FontWeight.Semibold
            Height: =37
            HoverBorderColor: =LblEmptyRequests.BorderColor
            HoverColor: =LblEmptyRequests.Color
            HoverFill: =LblEmptyRequests.Fill
            PressedBorderColor: =LblEmptyRequests.BorderColor
            PressedColor: =LblEmptyRequests.Color
            PressedFill: =LblEmptyRequests.Fill
            Text: ="No " & If(_requestTypeFilter <> "All", Lower(_requestTypeFilter)) & " requests"
            Visible: =If(IsEmpty(Table1_14),true,false)
            Width: =190
            X: =268
            Y: =167
            ZIndex: =34

    GroupRequestDetails As group:
        Height: =5
        Width: =5
        X: =40
        Y: =40
        ZIndex: =36

        LblRequestDetailsHeader As label:
            Color: =RGBA(0, 71, 144, 1)
            FocusedBorderColor: =LblRequestDetailsHeader.BorderColor
            Font: =Font.Lato
            FontWeight: =FontWeight.Bold
            Height: =29
            HoverBorderColor: =LblRequestDetailsHeader.BorderColor
            HoverColor: =LblRequestDetailsHeader.Color
            HoverFill: =LblRequestDetailsHeader.Fill
            PressedBorderColor: =LblRequestDetailsHeader.BorderColor
            PressedColor: =LblRequestDetailsHeader.Color
            PressedFill: =LblRequestDetailsHeader.Fill
            Size: =13.5
            Text: ="Request Details"
            Width: =291
            X: =1075
            Y: =103
            ZIndex: =13

        GalleryRequestDetails As gallery.galleryVertical:
            AccessibleLabel: ="Selected request details"
            DisabledBorderColor: =GalleryRequestDetails.BorderColor
            DisabledFill: =GalleryRequestDetails.Fill
            Height: =CountRows(GalleryRequestDetails.AllItems)*75
            HoverBorderColor: =GalleryRequestDetails.BorderColor
            HoverFill: =GalleryRequestDetails.Fill
            Items: |-
                = //table of data specific to selected leave request item. Dynamically updates based on user selection from GalleryRequests
                If(_managerView, 
                    Table(
                        {Header: "Total time requested", 
                         Value: _requestedDays & " day(s)",
                         Image:Basel_Clock}, 
                        {Header: "Leave type", 
                         Value: _selectedLeaveItem.LeaveType,
                         Image: LookUp(LeaveTypeCollection, type=_selectedLeaveItem.LeaveType).icon},
                         {Header: "Leave details", 
                         Value: _selectedLeaveItem.Detail,
                         Image: Basel_detail_list},
                         If(CountRows(RequestOverlaps) > 0, 
                         {Header: Upper("Overlaps with other requests (" & CountRows(RequestOverlaps) & ")"),
                          Value: _requestOverlapMessage,
                          Image: "null"})
                         ), 
                    Table(
                        {Header: "Total time requested", 
                         Value: _requestedDays & " day(s)",
                         Image: Basel_Clock}, 
                        {Header: "Leave type", 
                         Value: _selectedLeaveItem.LeaveType,
                         Image: LookUp(LeaveTypeCollection, type=_selectedLeaveItem.LeaveType).icon},
                        {Header: "Request sent to", 
                         Value: _selectedApprover.DisplayName,
                         Image: _selectedApproverPhoto}))
            Layout: =Layout.Vertical
            LoadingSpinnerColor: =GalleryRequestDetails.BorderColor
            PressedBorderColor: =GalleryRequestDetails.BorderColor
            PressedFill: =GalleryRequestDetails.Fill
            ShowScrollbar: =false
            TemplateSize: =68
            Visible: =_showDetails
            Width: =360
            X: =1006
            Y: =154
            ZIndex: =24

            Label11 As label:
                FocusedBorderColor: =Label11.BorderColor
                FocusedBorderThickness: =2
                Height: =15
                HoverBorderColor: =Label11.BorderColor
                HoverColor: =Label11.Color
                HoverFill: =Label11.Fill
                Live: =Live.Polite
                OnSelect: =Select(Parent)
                PressedBorderColor: =Label11.BorderColor
                PressedColor: =Label11.Color
                PressedFill: =Label11.Fill
                Size: =9
                Text: =Upper(ThisItem.Header)
                Width: =235
                X: =71
                Y: =5
                ZIndex: =1

            Label9_3 As label:
                FocusedBorderColor: =Label9_3.BorderColor
                Font: =Font.Lato
                FontWeight: =FontWeight.Bold
                Height: =43
                HoverBorderColor: =Label9_3.BorderColor
                HoverColor: =Label9_3.Color
                HoverFill: =Label9_3.Fill
                LineHeight: =1.1
                Live: =Live.Polite
                PressedBorderColor: =Label9_3.BorderColor
                PressedColor: =Label9_3.Color
                PressedFill: =Label9_3.Fill
                Size: =12
                Text: =ThisItem.Value
                VerticalAlign: =VerticalAlign.Top
                Visible: =_showDetails
                Width: =266
                X: =71
                Y: =25
                ZIndex: =2

            Image1_1 As image:
                AccessibleLabel: =ThisItem.Header & " icon"
                FocusedBorderColor: =Image1_1.BorderColor
                Height: =58
                HoverBorderColor: =ColorFade(Image1_1.BorderColor, 20%)
                HoverFill: =ColorFade(Image1_1.Fill, 20%)
                Image: =ThisItem.Image
                PressedBorderColor: =ColorFade(Image1_1.BorderColor, -20%)
                PressedFill: =ColorFade(Image1_1.Fill, -20%)
                RadiusBottomLeft: =If(ThisItem.Header = "Request sent to", 25)
                RadiusBottomRight: =If(ThisItem.Header = "Request sent to", 25)
                RadiusTopLeft: =If(ThisItem.Header = "Request sent to", 25)
                RadiusTopRight: =If(ThisItem.Header = "Request sent to", 25)
                Visible: =ThisItem.Image <> "null"
                Width: =45
                X: =26
                Y: =10
                ZIndex: =3

        BtnEmailRequester As icon.Mail:
            AccessibleLabel: ="Email requester"
            Color: =RGBA(12, 132, 255, 1)
            DisabledFill: =BtnEmailRequester.Fill
            FocusedBorderColor: =BtnEmailRequester.BorderColor
            Height: =22
            HoverBorderColor: =ColorFade(BtnEmailRequester.BorderColor, 20%)
            HoverColor: =ColorFade(BtnEmailRequester.Color, 20%)
            HoverFill: =BtnEmailRequester.Fill
            Icon: =Icon.Mail
            OnSelect: =Navigate(ManagerSendEmailScreen, BorderStyle.None)
            PaddingRight: =0.00
            PaddingTop: =0.00
            PressedBorderColor: =ColorFade(BtnEmailRequester.BorderColor, -20%)
            PressedColor: =ColorFade(BtnEmailRequester.Color, -20%)
            PressedFill: =BtnEmailRequester.Fill
            TabIndex: =0
            Visible: =_showDetails && _managerView && Upper(GalleryRequests.Selected.Status) = Upper("Pending")
            Width: =24
            X: =1245
            Y: =BtnManagerApprove.Y + BtnManagerApprove.Height/2 - BtnEmailRequester.Height/2
            ZIndex: =25

        BtnManagerDecline As button:
            BorderColor: =RGBA(202, 202, 202, 1)
            BorderThickness: =1
            Color: =RGBA(213, 0, 0, 1)
            DisabledBorderColor: =ColorFade(BtnManagerDecline.BorderColor, 70%)
            Fill: =RGBA(255, 255, 255, 1)
            FocusedBorderColor: =BtnManagerDecline.BorderColor
            FocusedBorderThickness: =2
            Font: =Font.Lato
            Height: =26
            HoverBorderColor: =ColorFade(BtnManagerDecline.BorderColor, 20%)
            HoverColor: =BtnManagerDecline.Color
            HoverFill: =BtnManagerDecline.Fill
            OnSelect: |
                =Concurrent(
                    Patch(LeaveCollection, LookUp(LeaveCollection, LeaveID = GalleryRequests.Selected.LeaveID), {Status: "Declined"}),
                    Set(_managerApprove, false));
                Navigate(ManagerChangeRequestScreen, BorderStyle.None)
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =0
            PressedBorderColor: =BtnManagerDecline.Fill
            PressedColor: =BtnManagerDecline.Color
            PressedFill: =BtnManagerDecline.Fill
            RadiusBottomLeft: =13
            RadiusBottomRight: =13
            RadiusTopLeft: =13
            RadiusTopRight: =13
            Size: =10.5
            Text: ="Decline"
            Visible: =_showDetails && _managerView && Upper(GalleryRequests.Selected.Status) = Upper("Pending")
            Width: =91
            X: =1137
            Y: =GalleryRequestDetails.Y + GalleryRequestDetails.Height + 5
            ZIndex: =26

        BtnManagerApprove As button:
            BorderColor: =RGBA(202, 202, 202, 1)
            BorderThickness: =1
            Color: =RGBA(0, 128, 0, 1)
            DisabledBorderColor: =ColorFade(BtnManagerApprove.BorderColor, 70%)
            Fill: =RGBA(255, 255, 255, 1)
            FocusedBorderColor: =BtnManagerApprove.BorderColor
            FocusedBorderThickness: =2
            Font: =Font.Lato
            Height: =26
            HoverBorderColor: =ColorFade(BtnManagerApprove.BorderColor, 20%)
            HoverColor: =BtnManagerApprove.Color
            HoverFill: =BtnManagerApprove.Fill
            OnSelect: |-
                =Concurrent(
                    Set(_submittingRequest, true),
                    //when approving leave, add the respective days used to the respective used days field
                    Patch(BalanceCollection, LookUp(BalanceCollection, BalanceID =  _requesterBalanceRecord.BalanceID),
                        If(Upper(GalleryRequests.Selected.LeaveType) = Upper("Vacation"), {VacationUsed: _requesterBalanceRecord.VacationUsed + _requestedDays},
                        Upper(GalleryRequests.Selected.LeaveType) = Upper("Sick leave"), {SickUsed: _requesterBalanceRecord.SickUsed + _requestedDays},
                        Upper(GalleryRequests.Selected.LeaveType) = Upper("Floating holiday"), {FloatingUsed: _requesterBalanceRecord.FloatingUsed + _requestedDays},
                        Upper(GalleryRequests.Selected.LeaveType) = Upper("Jury duty"), {JuryDutyUsed: _requesterBalanceRecord.JuryDutyUsed + _requestedDays},
                        Upper(GalleryRequests.Selected.LeaveType) = Upper("Bereavement"), {BereavementUsed: _requesterBalanceRecord.BereavementUsed + _requestedDays}
                        )
                    ),
                    Set(_managerApprove, true));
                Patch(LeaveCollection, LookUp(LeaveCollection, LeaveID = GalleryRequests.Selected.LeaveID), {Status: "Approved"});
                Set(_submittingRequest, false);
                Navigate(ManagerChangeRequestScreen, BorderStyle.None);
                      
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =0
            PressedBorderColor: =BtnManagerApprove.Fill
            PressedColor: =BtnManagerApprove.Color
            PressedFill: =BtnManagerApprove.Fill
            RadiusBottomLeft: =13
            RadiusBottomRight: =13
            RadiusTopLeft: =13
            RadiusTopRight: =13
            Size: =10.5
            Text: ="Approve"
            Visible: =_showDetails && _managerView && Upper(GalleryRequests.Selected.Status) = Upper("Pending")
            Width: =91
            X: =1037
            Y: =GalleryRequestDetails.Y + GalleryRequestDetails.Height + 5
            ZIndex: =27

        LblRequesterEdit As label:
            BorderColor: =RGBA(0, 0, 0, 1)
            Color: =RGBA(10, 106, 204, 1)
            FocusedBorderColor: =LblRequesterEdit.BorderColor
            FocusedBorderThickness: =2
            Font: =Font.Lato
            FontWeight: =FontWeight.Bold
            Height: =20
            HoverBorderColor: =LblRequesterEdit.BorderColor
            HoverColor: =LblRequesterEdit.Color
            HoverFill: =LblRequesterEdit.Fill
            LineHeight: =1
            Live: =Live.Polite
            OnSelect: |
                =Set(_editingRequest, true);
                Navigate(NewRequestScreen, BorderStyle.None)
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =0
            PressedBorderColor: =LblRequesterEdit.BorderColor
            PressedColor: =LblRequesterEdit.Color
            PressedFill: =LblRequesterEdit.Fill
            Size: =10.5
            Text: ="Edit"
            Visible: =!_managerView && _showDetails && Upper(GalleryRequests.Selected.Status) = Upper("Pending")
            Width: =68
            X: =1075
            Y: =378
            ZIndex: =28

        IconRequesterEdit As icon.Edit:
            AccessibleLabel: ="Edit request"
            Color: =RGBA(10, 106, 204, 1)
            DisabledFill: =IconRequesterEdit.Fill
            FocusedBorderColor: =IconRequesterEdit.BorderColor
            Height: =20
            HoverBorderColor: =ColorFade(IconRequesterEdit.BorderColor, 20%)
            HoverColor: =ColorFade(IconRequesterEdit.Color, 20%)
            HoverFill: =IconRequesterEdit.Fill
            Icon: =Icon.Edit
            OnSelect: |
                =Set(_editingRequest, true);
                Navigate(NewRequestScreen, BorderStyle.None)
            PressedBorderColor: =ColorFade(IconRequesterEdit.BorderColor, -20%)
            PressedColor: =ColorFade(IconRequesterEdit.Color, -20%)
            PressedFill: =IconRequesterEdit.Fill
            TabIndex: =0
            Visible: =!_managerView && _showDetails && Upper(GalleryRequests.Selected.Status) = Upper("Pending")
            Width: =20
            X: =1043
            Y: =378
            ZIndex: =29

    Navigation_5 As Navigation:
        CurrentScreen: ="My Leave Requests"
        NavItem: =If(_managerView,ManagerNavigation,EmployeeNavigation)
        Y: =80
        ZIndex: =43

    AllButton As button:
        BorderColor: =RGBA(56, 86, 153, 1)
        Color: =RGBA(62, 96, 170, 1)
        Fill: =RGBA(255, 255, 255, 1)
        OnSelect: =
        RadiusBottomLeft: =25
        RadiusBottomRight: =25
        RadiusTopLeft: =25
        RadiusTopRight: =25
        Text: ="All"
        Width: =142
        X: =316
        Y: =103
        ZIndex: =51

    Header_11 As group:
        Height: =5
        Width: =5
        X: =40
        Y: =20
        ZIndex: =51

        Rectangle1_11 As rectangle:
            DisabledFill: =Rectangle1_11.Fill
            Fill: =RGBA(0, 71, 144, 1)
            FocusedBorderColor: =Rectangle1_11.BorderColor
            Height: =80
            HoverFill: =Rectangle1_11.Fill
            PressedFill: =Rectangle1_11.Fill
            Width: =1366
            ZIndex: =44

        LblHeaderTItle1_11 As label:
            Color: =RGBA(255, 255, 255, 1)
            FocusedBorderColor: =LblHeaderTItle1_11.BorderColor
            Font: =Font.Lato
            Height: =80
            HoverBorderColor: =LblHeaderTItle1_11.BorderColor
            HoverColor: =LblHeaderTItle1_11.Color
            HoverFill: =LblHeaderTItle1_11.Fill
            PressedBorderColor: =LblHeaderTItle1_11.BorderColor
            PressedColor: =LblHeaderTItle1_11.Color
            PressedFill: =LblHeaderTItle1_11.Fill
            Size: =18
            Text: =Upper("Request")
            Width: =117
            X: =30
            ZIndex: =45

        LblHeaderTitle2_11 As label:
            Color: =RGBA(255, 255, 255, 1)
            FocusedBorderColor: =LblHeaderTitle2_11.BorderColor
            Height: =80
            HoverBorderColor: =LblHeaderTitle2_11.BorderColor
            HoverColor: =LblHeaderTitle2_11.Color
            HoverFill: =LblHeaderTitle2_11.Fill
            PressedBorderColor: =LblHeaderTitle2_11.BorderColor
            PressedColor: =LblHeaderTitle2_11.Color
            PressedFill: =LblHeaderTitle2_11.Fill
            Size: =18
            Text: =Upper("Leave")
            Width: =138
            X: =178
            ZIndex: =46

        icon2_11 As icon.ArrowRight:
            Color: =Color.White
            DisabledFill: =icon2_11.Fill
            FocusedBorderColor: =icon2_11.BorderColor
            HoverBorderColor: =ColorFade(icon2_11.BorderColor, 20%)
            HoverColor: =ColorFade(icon2_11.Color, 20%)
            HoverFill: =icon2_11.Fill
            Icon: =Icon.ArrowRight
            PressedBorderColor: =ColorFade(icon2_11.BorderColor, -20%)
            PressedColor: =ColorFade(icon2_11.Color, -20%)
            PressedFill: =icon2_11.Fill
            Width: =32
            X: =143
            Y: =9
            ZIndex: =47

        CircleHeaderCreateNew_9 As circle:
            DisabledFill: =CircleHeaderCreateNew_9.Fill
            Fill: =Color.White
            FocusedBorderColor: =CircleHeaderCreateNew_9.BorderColor
            Height: =46
            HoverFill: =CircleHeaderCreateNew_9.Fill
            PressedFill: =CircleHeaderCreateNew_9.Fill
            Width: =46
            X: =1155
            Y: =17
            ZIndex: =48

        IconHeaderCreateNew_9 As icon.Add:
            AccessibleLabel: ="Create new leave request"
            Color: =Rectangle1_11.Fill
            DisabledFill: =IconHeaderCreateNew_9.Fill
            FocusedBorderColor: =IconHeaderCreateNew_9.BorderColor
            Height: =46
            HoverBorderColor: =ColorFade(IconHeaderCreateNew_9.BorderColor, 20%)
            HoverColor: =ColorFade(IconHeaderCreateNew_9.Color, 20%)
            HoverFill: =IconHeaderCreateNew_9.Fill
            Icon: =Icon.Add
            OnSelect: |
                =Navigate(NewRequestScreen, BorderStyle.None);
                Set(_selectedLeaveType,Blank());
                Set(_editingRequest, false)
            PaddingBottom: =7
            PaddingLeft: =7
            PaddingRight: =7
            PaddingTop: =7
            PressedBorderColor: =ColorFade(IconHeaderCreateNew_9.BorderColor, -20%)
            PressedColor: =ColorFade(IconHeaderCreateNew_9.Color, -20%)
            PressedFill: =IconHeaderCreateNew_9.Fill
            TabIndex: =0
            Width: =46
            X: =CircleHeaderCreateNew_9.X
            Y: =17
            ZIndex: =49

        LblHeaderCreateNew_9 As label:
            Color: =RGBA(255, 255, 255, 1)
            FocusedBorderColor: =LblHeaderCreateNew_9.BorderColor
            FocusedBorderThickness: =02
            Font: =Font.Lato
            FontWeight: =FontWeight.Bold
            Height: =80
            HoverBorderColor: =LblHeaderCreateNew_9.BorderColor
            HoverColor: =LblHeaderCreateNew_9.Color
            HoverFill: =LblHeaderCreateNew_9.Fill
            OnSelect: =
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =0
            PressedBorderColor: =LblHeaderCreateNew_9.BorderColor
            PressedColor: =LblHeaderCreateNew_9.Color
            PressedFill: =LblHeaderCreateNew_9.Fill
            Size: =13.5
            Text: ="Create Request"
            Width: =155
            X: =1211
            ZIndex: =50

    PendingButton As button:
        BorderColor: =RGBA(56, 86, 153, 1)
        Color: =RGBA(62, 96, 170, 1)
        Fill: =RGBA(255, 255, 255, 1)
        OnSelect: |-
            =
            UpdateContext({FilterByPending:!FilterByPending})
        RadiusBottomLeft: =25
        RadiusBottomRight: =25
        RadiusTopLeft: =25
        RadiusTopRight: =25
        Text: ="Pending"
        Width: =142
        X: =475
        Y: =103
        ZIndex: =52

    ApprovedButton As button:
        BorderColor: =RGBA(56, 86, 153, 1)
        Color: =RGBA(62, 96, 170, 1)
        Fill: =RGBA(255, 255, 255, 1)
        OnSelect: |-
            =UpdateContext({FilterByApproved:!FilterByApproved})
        RadiusBottomLeft: =25
        RadiusBottomRight: =25
        RadiusTopLeft: =25
        RadiusTopRight: =25
        Text: ="Approved"
        Width: =142
        X: =638
        Y: =103
        ZIndex: =53

    DeclinedButton As button:
        BorderColor: =RGBA(56, 86, 153, 1)
        Color: =RGBA(62, 96, 170, 1)
        Fill: =RGBA(255, 255, 255, 1)
        OnSelect: |-
            =UpdateContext({FilterByDeclined:!FilterByDeclined})
        RadiusBottomLeft: =25
        RadiusBottomRight: =25
        RadiusTopLeft: =25
        RadiusTopRight: =25
        Text: ="Declined"
        Width: =142
        X: =806
        Y: =103
        ZIndex: =54

